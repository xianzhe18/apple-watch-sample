var scrollAvailable;function polar2ortho(t,a){return{x:t*Math.cos(a),y:t*Math.sin(a)}}function ortho2polar(t,a){return{r:Math.sqrt(Math.pow(t,2)+Math.pow(a,2)),rad:Math.atan2(a,t)}}FastClick.attach(document.body),$.fn.extend({transform:function(t){this.each(function(){var a=$(this);void 0===a.data("transform")&&a.data("transform",{}),$.extend(a.data("transform"),t);var e,o=["0","0","0"],c="1";for(n in a.data("transform"))switch(n){case"x":"number"==typeof a.data("transform").x?o[0]=a.data("transform").x+"px":o[0]=a.data("transform").x;break;case"y":"number"==typeof a.data("transform").y?o[1]=a.data("transform").y+"px":o[1]=a.data("transform").y;break;case"z":"number"==typeof a.data("transform").z?o[2]=a.data("transform").z+"px":o[2]=a.data("transform").z;break;case"scale":c=a.data("transform").scale}e=(o=o===["0","0","0"]?"":"translate3d("+o+")")+" "+(c="1"===c?"":"scale("+c+")"),a.css("transform",e)})}});var WATCH=function(){this.screen=$("#screen-container"),this.scrollX=0,this.scrollY=0,this.scrollMoveX=0,this.scrollMoveY=0,this.lastX=void 0,this.lastY=void 0,this.deltaX=void 0,this.deltaY=void 0,this.scrollRangeX=30,this.scrollRangeY=10,this.inertia=void 0,this.inertiaX=void 0,this.inertiaY=void 0,this.scrollAvailable=!0,this.iconSize=200,this.iconDistance=180,this.autoAdd=!1,this.isFullCube=!1,this.scale=1,this.range=200,mobileCheck()&&(this.iconSize=120,this.iconDistance=100),this.edge=this.iconDistance/6};window.mobileCheck=function(){let t=!1;var a;return a=navigator.userAgent||navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(a.substr(0,4)))&&(t=!0),t},WATCH.prototype.init=function(){var t=window.location.href;if(-1===t.indexOf("formdev.herokuapp.com")&&-1===t.indexOf("localhost"))return void $("body").html("Illegal access!");this.screenW=$("#screen-container").outerWidth(),this.screenH=$("#screen-container").outerHeight(),this.centerW=this.screenW/2,this.centerH=this.screenH/2,this.range=Math.min(this.screenW,this.screenH)/2,this.contentTxtArr=new Array,this.iconArr=new Array;for(var a=1;a<11;a++)this.iconArr.push("img/avatars/"+a+".png");for(a=0;a<$(".appicon").length;a++)$(".appicon").eq(a).css({"background-image":this.iconArr[Math.floor(10*Math.random())]});let e=this.iconDistance*this.scale,o=Math.floor(1.5*this.screenW/e),c=Math.floor(1.5*this.screenH/e);for(this.hexCube=new Array,a=0;a<=Math.max(o,c);a++)for(var n=-a;n<=a;n++)for(var i=-a;i<=a;i++)Math.abs(n)<=o&&Math.abs(i)<=c&&(a===Math.abs(n)||a===Math.abs(i))&&(n+i)%2==0&&this.hexCube.push([n,i]);$("#border-box-2x").css({width:this.screenW-4*this.edge,height:this.screenH-4*this.edge}),$("#border-box-4x").css({width:this.screenW-8*this.edge,height:this.screenH-8*this.edge})},WATCH.prototype.iconMapRefresh=function(t,a,e,o,c){var n,i,s=[],r={},l=[],h={iconZoom:1,edgeZoom:!0};for(m in $.extend(h,c||{}),void 0===o?(n=0,i=0):(n=o.x,i=o.y),this.hexCube)s[m]={x:this.hexCube[m][0]*a+n,y:this.hexCube[m][1]*a+i},r=ortho2polar(s[m].x,s[m].y),l[m]={r:r.r,depth:$.easing.easeInOutCubic(null,1,1,-.5,1),rad:r.rad};if(!0===h.edgeZoom){var d,u,w=watch.edge;for(m in s)d=s[m],u=l[m],Math.abs(d.x)>this.screenW/2||Math.abs(d.y)>this.screenH/2?d.scale=.2*u.depth:Math.abs(d.x)>this.screenW/2-4*w&&Math.abs(d.y)>this.screenH/2-4*w?d.scale=Math.min(u.depth*$.easing.easeOutSine(null,this.screenW/2-Math.abs(d.x)-2*w,.6,.4,2*w),u.depth*$.easing.easeOutSine(null,this.screenH/2-Math.abs(d.y)-2*w,.6,.4,2*w)):Math.abs(d.x)>this.screenW/2-4*w?d.scale=u.depth*$.easing.easeOutSine(null,this.screenW/2-Math.abs(d.x)-2*w,.6,.4,2*w):Math.abs(d.y)>this.screenH/2-4*w?d.scale=u.depth*$.easing.easeOutSine(null,this.screenH/2-Math.abs(d.y)-2*w,.6,.4,2*w):d.scale=u.depth;for(m in s)d=s[m],Math.abs(d.x)<this.screenW/2+w&&(d.x<-this.screenW/2+w?d.x+=$.easing.easeInCubic(null,this.screenW/2-Math.abs(d.x)-2*w,0,w,2*w):d.x>this.screenW/2-w&&(d.x+=$.easing.easeInCubic(null,this.screenW/2-Math.abs(d.x)-2*w,0,-w,2*w))),Math.abs(d.y)<this.screenH/2+w&&(d.y<-this.screenH/2+w?d.y+=$.easing.easeInCubic(null,this.screenH/2-Math.abs(d.y)-2*w,0,w,2*w):d.y>this.screenH/2-w&&(d.y+=$.easing.easeInCubic(null,this.screenH/2-Math.abs(d.y)-2*w,0,-w,2*w)))}if(0!=e)$(".appicon").eq(e).transform({x:s[e].x,y:s[e].y,scale:s[e].scale});else for(var m=0;m<$(".appicon").length;m++)d=s[m],$(".appicon").eq(m).transform({x:d.x,y:d.y,scale:d.scale})};var watch=new WATCH;function addContent(){if(!$("#contentTxt").val().trim())return void $("#validate").css({display:"block"}).html("入力エラー");var t=watch.iconArr[Math.floor(10*Math.random())],a=$(".appicon").length;const e=document.createElement("div");e.className="appicon",document.getElementById("home").appendChild(e),$("<img/>").attr("src",t).on("load",function(){$(this).remove();var o,c=document.getElementById("contentTxt");watch.contentTxtArr.push(c.value),e.setAttribute("data-toggle","popover-click"),e.setAttribute("data-placement","bottom"),e.id=a,e.setAttribute("data-content",c.value),e.setAttribute("data-image",t),e.style.height=watch.iconSize+"px",e.style.width=watch.iconSize+"px",e.style.backgroundImage="url("+t+")",e.style.cursor="pointer",watch.autoAdd?o=12:(o=36,c.value=""),watch.iconMapRefresh(watch.range,$.easing.easeOutCubic(null,0,watch.iconDistance,watch.iconDistance/2,o),a,{x:watch.scrollX,y:watch.scrollY});var n=0,i=setInterval(function(){n>o&&(clearInterval(i),scrollAvailable=!0,watch.isFullCube?$(".add-block").remove():watch.autoAdd&&addContent()),watch.iconMapRefresh(watch.range,$.easing.easeOutCubic(null,n,watch.iconDistance,-watch.iconDistance/2,o),a,{x:watch.scrollX,y:watch.scrollY}),n++},16)}),a===watch.hexCube.length-1&&(watch.isFullCube=!0)}function homeOpening(){scrollAvailable=!1;var t="scale("+watch.scale+")";$("#home").css({transform:t,opacity:0,transition:"300ms cubic-bezier(0.19, 1, 0.22, 1)"}),setTimeout(function(){$("#home").css({transform:"scale(4)",opacity:0,transition:"0s"}),watch.scrollX=0,watch.scrollY=0,watch.scrollMoveX=0,watch.scrollMoveY=0,watch.iconMapRefresh(watch.range,watch.iconDistance/2,0,{x:0,y:0});var a=0,e=setInterval(function(){a>36&&(clearInterval(e),scrollAvailable=!0),watch.iconMapRefresh(watch.range,$.easing.easeOutCubic(null,a,watch.iconDistance,-watch.iconDistance/2,36),0,{x:0,y:0}),a++},16);setTimeout(function(){$("#home").css({transform:t,opacity:1,transition:"600ms cubic-bezier(0.19, 1, 0.22, 1)"})})},600)}$(document).on("touchmove",function(t){t.preventDefault()}),$(document).ready(function(){watch.init(),homeOpening(),$("#screen-container").on("touchstart mousedown",function(t){if($(".appicon").popover("hide"),!1!==scrollAvailable){if(void 0!==t.originalEvent.touches){if(2===t.originalEvent.touches.length)return void t.preventDefault();t.originalEvent=t.originalEvent.touches[0]}$(window).off("touchmove mousemove"),watch.lastX=t.originalEvent.pageX,watch.lastY=t.originalEvent.pageY,watch.deltaX=t.originalEvent.pageX-watch.lastX,watch.deltaY=t.originalEvent.pageY-watch.lastY,watch.scrollMoveX+=watch.deltaX,watch.scrollMoveY+=watch.deltaY,watch.scrollX=watch.scrollMoveX,watch.scrollY=watch.scrollMoveY,clearInterval(watch.inertia),$(window).on("touchmove mousemove",function(t){t.preventDefault(),t.stopPropagation(),void 0!==t.originalEvent.touches&&(t.originalEvent=t.originalEvent.touches[0]),watch.deltaX=t.originalEvent.pageX-watch.lastX,watch.deltaY=t.originalEvent.pageY-watch.lastY,watch.lastX=t.originalEvent.pageX,watch.lastY=t.originalEvent.pageY,watch.scrollMoveX+=watch.deltaX,watch.scrollMoveY+=watch.deltaY,watch.scrollX=watch.scrollMoveX,watch.scrollY=watch.scrollMoveY,watch.scrollMoveX>watch.scrollRangeX?watch.scrollX=watch.scrollRangeX+1.35*(watch.scrollMoveX-watch.scrollRangeX):watch.scrollX<-watch.scrollRangeX&&(watch.scrollX=-watch.scrollRangeX+1.35*(watch.scrollMoveX+watch.scrollRangeX)),watch.scrollMoveY>watch.scrollRangeY?watch.scrollY=watch.scrollRangeY+1.35*(watch.scrollMoveY-watch.scrollRangeY):watch.scrollY<-watch.scrollRangeY&&(watch.scrollY=-watch.scrollRangeY+1.35*(watch.scrollMoveY+watch.scrollRangeY)),watch.iconMapRefresh(watch.range,watch.iconDistance/2,0,{x:watch.scrollX,y:watch.scrollY})}),$(window).on("touchend mouseup",function(t){$(window).off("touchmove mousemove touchend mouseup")})}}),$("#contentTxt").bind("input propertychange",function(){$("#validate").css({display:"none"})}),$("body").click(function(t){$(t.target).is(".container")&&$("#profileModal").modal("hide")}),$("#home").delegate(".appicon","click",function(){var t=$(this).data("image"),a=$(this).attr("id");$("#profileImg").css({"background-image":"url("+t+")"}),$("#profileDesc").html(watch.contentTxtArr[a]),$("#profileModal").modal({backdrop:!1})}),$("#modalCloseBtn").click(function(){$("#profileModal").modal("hide")}),$("#addBtn").on("click",addContent),$("#autoAddBtn").on("click",function(){watch.autoAdd=!0,addContent()})});