function polar2ortho(a,t){return{x:a*Math.cos(t),y:a*Math.sin(t)}}function ortho2polar(a,t){return{r:Math.sqrt(Math.pow(a,2)+Math.pow(t,2)),rad:Math.atan2(t,a)}}FastClick.attach(document.body),$(document).on("touchmove",function(a){a.preventDefault()}),$.fn.extend({transform:function(a){this.each(function(){var t=$(this);void 0===t.data("transform")&&t.data("transform",{}),$.extend(t.data("transform"),a);var e,o=["0","0","0"],s="1";for(n in t.data("transform"))switch(n){case"x":"number"==typeof t.data("transform").x?o[0]=t.data("transform").x+"px":o[0]=t.data("transform").x;break;case"y":"number"==typeof t.data("transform").y?o[1]=t.data("transform").y+"px":o[1]=t.data("transform").y;break;case"z":"number"==typeof t.data("transform").z?o[2]=t.data("transform").z+"px":o[2]=t.data("transform").z;break;case"scale":s=t.data("transform").scale}e=(o=o===["0","0","0"]?"":"translate3d("+o+")")+" "+(s="1"===s?"":"scale("+s+")"),t.css("transform",e)})}});var WATCH=function(){this.screen=$("#screen-container"),this.scrollX=0,this.scrollY=0,this.scrollMoveX=0,this.scrollMoveY=0,this.lastX=void 0,this.lastY=void 0,this.deltaX=void 0,this.deltaY=void 0,this.scrollRangeX=30,this.scrollRangeY=10,this.inertia=void 0,this.inertiaX=void 0,this.inertiaY=void 0,this.scrollAvailable=!0,this.iconSize=200,this.iconDistance=180,this.autoAdd=!1,this.isFullCube=!1,this.scale=1,this.range=200,mobileCheck()&&(this.iconSize=120,this.iconDistance=100)};window.mobileCheck=function(){let a=!1;var t;return t=navigator.userAgent||navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))&&(a=!0),a},WATCH.prototype.init=function(){if(-1===window.location.href.indexOf("formdev.herokuapp.com"))return void $("body").html("Illegal access!");this.screenW=$("#screen-container").outerWidth(),this.screenH=$("#screen-container").outerHeight(),this.centerW=this.screenW/2,this.centerH=this.screenH/2,this.range=Math.min(this.screenW,this.screenH)/2,this.contentTxtArr=new Array,this.iconArr=new Array,this.iconArr.push("url('img/avatars/1.png')"),this.iconArr.push("url('img/avatars/2.png')"),this.iconArr.push("url('img/avatars/3.png')"),this.iconArr.push("url('img/avatars/4.png')"),this.iconArr.push("url('img/avatars/5.png')"),this.iconArr.push("url('img/avatars/6.png')"),this.iconArr.push("url('img/avatars/7.png')"),this.iconArr.push("url('img/avatars/8.png')"),this.iconArr.push("url('img/avatars/9.png')"),this.iconArr.push("url('img/avatars/10.png')");for(var a=0;a<$(".appicon").length;a++)$(".appicon").eq(a).css({"background-image":this.iconArr[Math.floor(10*Math.random())]});let t=this.iconDistance*this.scale,e=Math.floor(1.5*this.screenW/t),n=Math.floor(1.5*this.screenH/t);this.hexCube=new Array;for(a=0;a<=Math.max(e,n);a++)for(var o=-a;o<=a;o++)for(var s=-a;s<=a;s++)Math.abs(o)<=e&&Math.abs(s)<=n&&(a===Math.abs(o)||a===Math.abs(s))&&(o+s)%2==0&&this.hexCube.push([o,s])},WATCH.prototype.iconMapRefresh=function(a,t,e,n,o){var s,c,i=[],r={},l=[],h={iconZoom:1,edgeZoom:!0};for(m in $.extend(h,o||{}),void 0===n?(s=0,c=0):(s=n.x,c=n.y),this.hexCube)i[m]={x:this.hexCube[m][0]*t+s,y:this.hexCube[m][1]*t+c},r=ortho2polar(i[m].x,i[m].y),l[m]={r:r.r,depth:$.easing.easeInOutCubic(null,1,1,-.5,1),rad:r.rad};if(!0===h.edgeZoom){var d,u,p=watch.iconDistance/3;for(m in i)d=i[m],u=l[m],Math.abs(d.x)>this.screenW/2-p||Math.abs(d.y)>this.screenH/2-p?d.scale=.4*u.depth:Math.abs(d.x)>this.screenW/2-4*p&&Math.abs(d.y)>this.screenH/2-4*p?d.scale=Math.min(u.depth*$.easing.easeOutSine(null,this.screenW/2-Math.abs(d.x)-2*p,.6,.4,2*p),u.depth*$.easing.easeOutSine(null,this.screenH/2-Math.abs(d.y)-2*p,.6,.4,2*p)):Math.abs(d.x)>this.screenW/2-2*p?d.scale=u.depth*$.easing.easeOutSine(null,this.screenW/2-Math.abs(d.x)-2*p,.6,.4,2*p):Math.abs(d.y)>this.screenH/2-2*p?d.scale=u.depth*$.easing.easeOutSine(null,this.screenH/2-Math.abs(d.y)-2*p,.6,.4,2*p):Math.abs(d.x)>this.screenW/2-4*p?d.scale=u.depth*$.easing.easeOutSine(null,this.screenW/2-Math.abs(d.x)-2*p,.6,.4,2*p):Math.abs(d.y)>this.screenH/2-4*p?d.scale=u.depth*$.easing.easeOutSine(null,this.screenH/2-Math.abs(d.y)-2*p,.6,.4,2*p):d.scale=u.depth;for(m in i)d=i[m],Math.abs(d.x)<this.screenW/2+p&&(d.x<-this.screenW/2+p?d.x+=$.easing.easeInSine(null,this.screenW/2-Math.abs(d.x)-2*p,0,-60,2*p):d.x>this.screenW/2-p&&(d.x+=$.easing.easeInSine(null,this.screenW/2-Math.abs(d.x)-2*p,0,60,2*p))),Math.abs(d.y)<this.screenH/2+p&&(d.y<-this.screenH/2+p?d.y+=$.easing.easeInSine(null,this.screenH/2-Math.abs(d.y)-2*p,0,-80,2*p):d.y>this.screenH/2-p&&(d.y+=$.easing.easeInSine(null,this.screenH/2-Math.abs(d.y)-2*p,0,80,2*p)))}if(0!=e)$(".appicon").eq(e).transform({x:i[e].x,y:i[e].y,scale:i[e].scale});else for(var m=0;m<$(".appicon").length;m++)d=i[m],$(".appicon").eq(m).transform({x:d.x,y:d.y,scale:d.scale})};var watch=new WATCH;function addContent(){if(""==$("#contentTxt").val())return $("#validate").css({display:"block"}),void $("#validate").html("入力エラー");const a=document.createElement("div");a.className="appicon",a.setAttribute("data-toggle","popover-click"),a.setAttribute("data-placement","bottom"),a.style.height=watch.iconSize+"px",a.style.width=watch.iconSize+"px",document.getElementById("home").appendChild(a);var t=$(".appicon").length;a.id=t-1;var e=document.getElementById("contentTxt");watch.contentTxtArr.push(e.value),a.setAttribute("data-content",e.value);var n=watch.iconArr[Math.floor(10*Math.random())];$(".appicon").eq(t-1).css({"background-image":n});var o=document.getElementById(t-1);o.style.cursor="pointer",o.onclick=function(){$("#profileImg").css({"background-image":n}),$("#profileDesc").html(watch.contentTxtArr[t-1]),$("#profileModal").modal({backdrop:!1})},watch.iconMapRefresh(watch.range,$.easing.easeOutCubic(null,0,watch.iconDistance,watch.iconDistance/2,36),t-1,{x:watch.scrollX,y:watch.scrollY}),watch.autoAdd||(e.value="");var s=0,c=setInterval(function(){s>36&&(clearInterval(c),scrollAvailable=!0),watch.iconMapRefresh(watch.range,$.easing.easeOutCubic(null,s,watch.iconDistance,-watch.iconDistance/2,36),t-1,{x:watch.scrollX,y:watch.scrollY}),s++},16);t===watch.hexCube.length&&($(".add-block").remove(),watch.isFullCube=!0)}function homeOpening(){scrollAvailable=!1;var a="scale("+watch.scale+")";$("#home").css({transform:a,opacity:0,transition:"300ms cubic-bezier(0.19, 1, 0.22, 1)"}),setTimeout(function(){$("#home").css({transform:"scale(4)",opacity:0,transition:"0s"}),watch.scrollX=0,watch.scrollY=0,watch.scrollMoveX=0,watch.scrollMoveY=0,watch.iconMapRefresh(watch.range,watch.iconDistance/2,0,{x:0,y:0});var t=0,e=setInterval(function(){t>36&&(clearInterval(e),scrollAvailable=!0),watch.iconMapRefresh(watch.range,$.easing.easeOutCubic(null,t,watch.iconDistance,-watch.iconDistance/2,36),0,{x:0,y:0}),t++},16);setTimeout(function(){$("#home").css({transform:a,opacity:1,transition:"600ms cubic-bezier(0.19, 1, 0.22, 1)"})})},600)}$("#screen-container").on("touchstart mousedown",function(a){if($(".appicon").popover("hide"),!1!==scrollAvailable){if(void 0!==a.originalEvent.touches){if(2===a.originalEvent.touches.length)return void a.preventDefault();a.originalEvent=a.originalEvent.touches[0]}$(window).off("touchmove mousemove"),watch.lastX=a.originalEvent.pageX,watch.lastY=a.originalEvent.pageY,watch.deltaX=a.originalEvent.pageX-watch.lastX,watch.deltaY=a.originalEvent.pageY-watch.lastY,watch.scrollMoveX+=watch.deltaX,watch.scrollMoveY+=watch.deltaY,watch.scrollX=watch.scrollMoveX,watch.scrollY=watch.scrollMoveY,clearInterval(watch.inertia),$(window).on("touchmove mousemove",function(a){a.preventDefault(),a.stopPropagation(),void 0!==a.originalEvent.touches&&(a.originalEvent=a.originalEvent.touches[0]),watch.deltaX=a.originalEvent.pageX-watch.lastX,watch.deltaY=a.originalEvent.pageY-watch.lastY,watch.lastX=a.originalEvent.pageX,watch.lastY=a.originalEvent.pageY,watch.scrollMoveX+=watch.deltaX,watch.scrollMoveY+=watch.deltaY,watch.scrollX=watch.scrollMoveX,watch.scrollY=watch.scrollMoveY,watch.scrollMoveX>watch.scrollRangeX?watch.scrollX=watch.scrollRangeX+(watch.scrollMoveX-watch.scrollRangeX)/2:watch.scrollX<-watch.scrollRangeX&&(watch.scrollX=-watch.scrollRangeX+(watch.scrollMoveX+watch.scrollRangeX)/2),watch.scrollMoveY>watch.scrollRangeY?watch.scrollY=watch.scrollRangeY+(watch.scrollMoveY-watch.scrollRangeY)/2:watch.scrollY<-watch.scrollRangeY&&(watch.scrollY=-watch.scrollRangeY+(watch.scrollMoveY+watch.scrollRangeY)/2),watch.iconMapRefresh(watch.range,watch.iconDistance/2,0,{x:watch.scrollX,y:watch.scrollY})}),$(window).on("touchend mouseup",function(a){$(window).off("touchmove mousemove touchend mouseup")})}}),homeOpening(),$("#contentTxt").bind("input propertychange",function(){$("#validate").css({display:"none"})}),$("body").click(function(a){$(a.target).is(".container")&&$("#profileModal").modal("hide")}),$("#modalCloseBtn").click(function(){$("#profileModal").modal("hide")}),$("#addBtn").on("click",addContent),$("#autoAddBtn").on("click",function(){for(watch.autoAdd=!0;!watch.isFullCube;)addContent()}),$(document).ready(function(){watch.init()});